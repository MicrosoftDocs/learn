
In our scenario, you've been asked to assess the readiness of a legacy SQL Server database for migration to Azure SQL Database. Your task is to perform an assessment of their legacy database and identify any potential compatibility issues or changes that need to be made before migration. You should also review the schema of the database and identify any features or configurations that aren't supported in Azure SQL Database.

You already have Azure Data Studio installed in your machine with access to the database, and installing other tools requires approval from the IT department. You need to use the most appropriate tool for your specific requirement.

> [!NOTE]
> To complete this exercise, you need access to an Azure subscription to create Azure resources. If you don't have an Azure subscription, create a [free account](https://azure.microsoft.com/free/?azure-portal=true) before you begin.
>
> If you choose to perform this exercise in this module, be aware that you might incur costs in your Azure Subscription.

## Prerequisites

To run this exercise, ensure you have the following prerequisites in place before proceeding:

- Download and install [Azure Data Studio](https://learn.microsoft.com/sql/azure-data-studio/download-azure-data-studio) on your machine if you haven't already.
- Install Azure migration extension for Azure Data Studio.
- SQL Server 2022 with the latest [**AdventureWorks**](/sql/samples/adventureworks-install-configure) database. 
- Once the database has been restored, run the following command:

```sql
ALTER TABLE [Person].[Person] ADD [Next] VARCHAR(5);
```

- A SQL Server user with read access to the source database.

## Task 1: Run the compatibility assessment

In this scenario, you'll run the Azure migration extension for Azure Data Studio and run the compatibility assessments level, then view the results for an Azure SQL Database target.

1. Launch Azure Data Studio, select **New Connection** to establish a connection to the SQL Server instance with the **AdventureWorks** database.
1. After the connection succeeds, right click on the instance name, and select **Manage**.
1. Once the dashboard shows, select **Azure SQL Migration** on the General section.
1. Select **Migrate to Azure SQL**. The extension wizard page will show.
1. On **Step 1: Databases for assessment**, select the **AdventureWorks** database, then select **Next**.
1. On **Step 2: Assessment results and recommendations**, wait for the assessment to complete.

## Task 2: Review the assessment results

Now you can examine the recommendations generated by the migration extension:

1. On **Step 2: Assessment results and recommendations**, select **Azure SQL Database** as the **Azure SQL** target platform.
1. At the bottom of the page, select **View/Select** to view the assessment results. 
1. Select the **AdventureWorks** database. Take a moment to review the assessment results on the right side.
    We can see that the [Next] column that was added previously was flagged, as it may lead to an error in Azure SQL Database.
1. Select **Cancel** and choose **Azure SQL Managed Instance** instead as the **Azure SQL** target platform.
    >[!NOTE]
    >The [Next] column that was added previously is no longer flagged for Azure SQL Managed Instance, why is that? 
    >
    >This means that the [Next] column can be safely used on Azure SQL Managed Instance.
1. Alternatively, select **Save assessment report** to save the report in a JSON format.
1. Take a moment to review the JSON file, and its properties.

## Task 3: Fix the issue

1. Run the following T-SQL command on the **AdventureWorks** database.
    ```sql
    ALTER TABLE [Person].[Person] DROP COLUMN [Next];
    ```
1. Go back to the assessment page in the wizard, make sure to select **Azure SQL Database** as the **Azure SQL** target platform.
1. Select **View/Select** to view the assessment results.
1. You can see that the issue is no longer being flagged.

You've learned how to assess the readiness of a SQL Server database for migration to Azure SQL Database. By addressing compatibility issues and making essential schema changes or reporting them, you've taken an important step in mitigating potential technical issues that could arise in the future on Azure SQL Database.
