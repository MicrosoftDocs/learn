## Risks

When you use shared access signatures in your applications, you should be aware of two potential risks.

 -  If a SAS is compromised, it can be used by anyone who obtains it.
 -  If a SAS provided to a client application expires and the application is unable to retrieve a new SAS from your service, then the application's functionality may be hindered.

## Recommendations

The following recommendations for using shared access signatures can help mitigate risks.

 -  **Always use HTTPS to create or distribute a SAS**. If a SAS is passed over HTTP and intercepted, an attacker could intercept and use the SAS. These man-in-the-middle attacks can compromise sensitive data or allow for data corruption by the malicious user.
 -  **Reference stored access policies where possible**. Stored access policies give you the option to revoke permissions without having to regenerate the storage account keys. Set the storage account key expiration date far out in the future.
 -  **Use near-term expiration times on an unplanned SAS**. In this way, even if a SAS is compromised, it's valid only for a short time. This practice is important if you can't reference a stored access policy. Near-term expiration times also limit the amount of data that can be written to a blob by limiting the time available to upload to it.
 -  **Have clients automatically renew the SAS if necessary**. Clients should renew the SAS well before the expiration date. Renewing early allows time for retries if the service providing the SAS is unavailable.
 -  **Be careful with SAS start time**. If you set the start time for a SAS to now, then due to clock skew (differences in current time according to different machines), failures may be observed intermittently for the first few minutes. In general, set the start time to be at least 15 minutes in the past. Or, don't set it at all, which will make it valid immediately in all cases. The same generally applies to expiry time as well - remember that you may observe up to 15 minutes of clock skew in either direction on any request. For clients using a REST version prior to 2012-02-12, the maximum duration for a SAS that does not reference a stored access policy is 1 hour, and any policies specifying longer term than that will fail.
 -  **Be specific with the resource to be accessed**. A security best practice is to provide a user with the minimum required privileges. If a user only needs read access to a single entity, then grant them read access to that single entity, and not read/write/delete access to all entities. This also helps lessen the damage if a SAS is compromised because the SAS has less power in the hands of an attacker
 -  **Understand that your account will be billed for any usage, including that done with SAS**. If you provide write access to a blob, a user may choose to upload a 200-GB blob. If you've given them read access as well, they may choose to download it 10 times, incurring 2 TB in egress costs for you. Again, provide limited permissions to help mitigate the potential actions of malicious users. Use short-lived SAS to reduce this threat (but be mindful of clock skew on the end time).
 -  **Validate data written using SAS**. When a client application writes data to your storage account, keep in mind that there can be problems with that data. If your application requires that data be validated or authorized before it is ready to use, you should perform this validation after the data is written and before it is used by your application. This practice also protects against corrupt or malicious data being written to your account, either by a user who properly acquired the SAS, or by a user exploiting a leaked SAS.
 -  **Don't assume SAS is always the correct choice**. Sometimes the risks associated with a particular operation against your storage account outweigh the benefits of SAS. For such operations, create a middle-tier service that writes to your storage account after performing business rule validation, authentication, and auditing. Also, sometimes it's simpler to manage access in other ways. For example, if you want to make all blobs in a container publicly readable, you can make the container Public, rather than providing a SAS to every client for access.
 -  **Use Storage Analytics to monitor your application**. You can use logging and metrics to observe any spike in authentication failures due to an outage in your SAS provider service or to the inadvertent removal of a stored access policy.
